<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Create a project - Programmatic submissions</title> <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Create a project | Programmatic submissions</title> <meta name="generator" content="Jekyll v4.3.1" /> <meta property="og:title" content="Create a project" /> <meta property="og:locale" content="en_US" /> <link rel="canonical" href="http://localhost:4000/docs/create_a_project/create_a_project.html" /> <meta property="og:url" content="http://localhost:4000/docs/create_a_project/create_a_project.html" /> <meta property="og:site_name" content="Programmatic submissions" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Create a project" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","headline":"Create a project","url":"http://localhost:4000/docs/create_a_project/create_a_project.html"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="http://localhost:4000/" class="site-title lh-tight"> Programmatic submissions </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/docs/docs.html" class="nav-list-link">Submission guidelines</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/docs/introduction/introduction.html" class="nav-list-link">Basic concepts before start</a></li><li class="nav-list-item active"><a href="http://localhost:4000/docs/create_a_project/create_a_project.html" class="nav-list-link active">Create a project</a></li></ul></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Programmatic submissions" aria-label="Search Programmatic submissions" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="https://github.com/ebi-ait/ingest-programmatic-submissions" class="site-button" target="_blank" rel="noopener noreferrer" > Edit these Docs on GitHub </a> </li> </ul> </nav> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="http://localhost:4000/docs/docs.html">Submission guidelines</a></li> <li class="breadcrumb-nav-list-item"><span>Create a project</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <ul> </ul> <h1 class="no_toc" id="create-a-project-in-ingest"> <a href="#create-a-project-in-ingest" class="anchor-heading" aria-labelledby="create-a-project-in-ingest"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Create a project in ingest </h1> <h2 class="no_toc" id="purpose-of-this-document"> <a href="#purpose-of-this-document" class="anchor-heading" aria-labelledby="purpose-of-this-document"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Purpose of this document </h2> <p>This document is intended to give an introduction to the HCA ingest service, specifically targeting data and metadata in the system and how they interact in the ingest ecosystem of data.</p> <p>These documents will be coupled with a set of python notebooks, which will show examples of how to interact with the data.</p> <p>This is the <strong>create a project</strong> doc, which will explain how to create, modify and delete a project in ingest.</p> <h2 class="no_toc text-delta" id="table-of-contents"> <a href="#table-of-contents" class="anchor-heading" aria-labelledby="table-of-contents"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Table of contents </h2> <ol id="markdown-toc"> <li><a href="#step-by-step" id="markdown-toc-step-by-step">Step by step</a> <ol> <li><a href="#static-view" id="markdown-toc-static-view">Static view</a></li> <li><a href="#interactive-view-notebook" id="markdown-toc-interactive-view-notebook">Interactive view (Notebook)</a></li> </ol> </li> <li><a href="#understanding-the-metadata" id="markdown-toc-understanding-the-metadata">Understanding the metadata</a> <ol> <li><a href="#schema-fields" id="markdown-toc-schema-fields">Schema fields</a></li> <li><a href="#project-metadata-peculiarities-non-schema-fields" id="markdown-toc-project-metadata-peculiarities-non-schema-fields">Project metadata peculiarities (Non-schema fields)</a> <ol> <li><a href="#system-fields" id="markdown-toc-system-fields">System fields</a></li> <li><a href="#prioritisation-fields" id="markdown-toc-prioritisation-fields">Prioritisation fields</a></li> <li><a href="#triage-fields" id="markdown-toc-triage-fields">Triage fields</a></li> </ol> </li> </ol> </li> <li><a href="#creating-your-own-project-metadata" id="markdown-toc-creating-your-own-project-metadata">Creating your own project metadata</a></li> <li><a href="#api-utilities" id="markdown-toc-api-utilities">API utilities</a> <ol> <li><a href="#searching-forretrieving-your-project" id="markdown-toc-searching-forretrieving-your-project">Searching for/Retrieving your project</a></li> <li><a href="#updating-your-project" id="markdown-toc-updating-your-project">Updating your project</a></li> <li><a href="#deleting-your-project" id="markdown-toc-deleting-your-project">Deleting your project</a></li> <li><a href="#accessing-other-entities-from-the-project" id="markdown-toc-accessing-other-entities-from-the-project">Accessing other entities from the project</a></li> </ol> </li> </ol> <h2 id="step-by-step"> <a href="#step-by-step" class="anchor-heading" aria-labelledby="step-by-step"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step by step </h2> <p>In this section, a rendering of a python notebook showing the steps to create a project, step by step, can be expanded from below.</p> <h3 id="static-view"> <a href="#static-view" class="anchor-heading" aria-labelledby="static-view"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Static view </h3> <details> <summary> Project notebook (Markdown render) </summary> <h1 class="no_toc" id="create-a-project"> <a href="#create-a-project" class="anchor-heading" aria-labelledby="create-a-project"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Create a project </h1> <p>This notebook is intended to give an insight into how to generate a submission by using the python tools available, the <code class="language-plaintext highlighter-rouge">hca-ingest</code> library. This library, amongst other utilities for interacting with the Ingest service, contains a wrapper for Ingest‚Äôs API, which lets you easily create, update and delete.</p> <p>This section will be focused around <code class="language-plaintext highlighter-rouge">Projects</code></p> <h2 class="no_toc" id="download-example-project"> <a href="#download-example-project" class="anchor-heading" aria-labelledby="download-example-project"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Download example project </h2> <p>In order to have the files necessary for this guide, we‚Äôre going to download the template file for the project metadata</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">!</span><span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">raw</span><span class="p">.</span><span class="n">githubusercontent</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">ebi</span><span class="o">-</span><span class="n">ait</span><span class="o">/</span><span class="n">ingest</span><span class="o">-</span><span class="n">programmatic</span><span class="o">-</span><span class="n">submissions</span><span class="o">/</span><span class="n">main</span><span class="o">/</span><span class="n">_data</span><span class="o">/</span><span class="n">submission_example</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">example_project</span><span class="p">.</span><span class="n">json</span>
</code></pre></div> </div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>--2022-11-09 17:32:55--  https://raw.githubusercontent.com/ebi-ait/ingest-programmatic-submissions/main/_data/submission_example/project/example_project.json
Resolving raw.githubusercontent.com (raw.githubusercontent.com)... 185.199.108.133, 185.199.110.133, 185.199.111.133, ...
Connecting to raw.githubusercontent.com (raw.githubusercontent.com)|185.199.108.133|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 1232 (1.2K) [text/plain]
Saving to: ‚Äòexample_project.json‚Äô

example_project.jso 100%[===================&gt;]   1.20K  --.-KB/s    in 0s      

2022-11-09 17:32:55 (34.3 MB/s) - ‚Äòexample_project.json‚Äô saved [1232/1232]
</code></pre></div> </div> <h2 class="no_toc" id="set-up--libraries-and-dependencies"> <a href="#set-up--libraries-and-dependencies" class="anchor-heading" aria-labelledby="set-up--libraries-and-dependencies"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Set up libraries and dependencies </h2> <h3 class="no_toc" id="install-external-libraries"> <a href="#install-external-libraries" class="anchor-heading" aria-labelledby="install-external-libraries"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Install external libraries </h3> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">hca</span><span class="o">-</span><span class="n">ingest</span>
</code></pre></div> </div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/
Collecting hca-ingest
  Downloading hca-ingest-2.6.0.tar.gz (57 kB)
[K     |‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 57 kB 2.7 MB/s 
[?25hCollecting jsonref
  Downloading jsonref-1.0.1-py3-none-any.whl (9.5 kB)
Requirement already satisfied: openpyxl in /usr/local/lib/python3.7/dist-packages (from hca-ingest) (3.0.10)
Collecting polling
  Downloading polling-0.3.2.tar.gz (5.2 kB)
Requirement already satisfied: PyYAML&gt;=5.3.1 in /usr/local/lib/python3.7/dist-packages (from hca-ingest) (6.0)
Requirement already satisfied: requests[security] in /usr/local/lib/python3.7/dist-packages (from hca-ingest) (2.23.0)
Collecting xlsxwriter
  Downloading XlsxWriter-3.0.3-py3-none-any.whl (149 kB)
[K     |‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 149 kB 10.9 MB/s 
[?25hCollecting mergedeep
  Downloading mergedeep-1.3.4-py3-none-any.whl (6.4 kB)
Collecting cryptography
  Downloading cryptography-38.0.3-cp36-abi3-manylinux_2_24_x86_64.whl (4.1 MB)
[K     |‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4.1 MB 43.8 MB/s 
[?25hCollecting requests-cache
  Downloading requests_cache-0.9.7-py3-none-any.whl (48 kB)
[K     |‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 48 kB 4.6 MB/s 
[?25hRequirement already satisfied: cffi&gt;=1.12 in /usr/local/lib/python3.7/dist-packages (from cryptography-&gt;hca-ingest) (1.15.1)
Requirement already satisfied: pycparser in /usr/local/lib/python3.7/dist-packages (from cffi&gt;=1.12-&gt;cryptography-&gt;hca-ingest) (2.21)
Requirement already satisfied: et-xmlfile in /usr/local/lib/python3.7/dist-packages (from openpyxl-&gt;hca-ingest) (1.1.0)
Collecting urllib3&gt;=1.25.5
  Downloading urllib3-1.26.12-py2.py3-none-any.whl (140 kB)
[K     |‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 140 kB 72.8 MB/s 
[?25hRequirement already satisfied: appdirs&gt;=1.4.4 in /usr/local/lib/python3.7/dist-packages (from requests-cache-&gt;hca-ingest) (1.4.4)
Collecting cattrs&gt;=22.2
  Downloading cattrs-22.2.0-py3-none-any.whl (35 kB)
Requirement already satisfied: attrs&gt;=21.2 in /usr/local/lib/python3.7/dist-packages (from requests-cache-&gt;hca-ingest) (22.1.0)
Collecting url-normalize&gt;=1.4
  Downloading url_normalize-1.4.3-py2.py3-none-any.whl (6.8 kB)
Collecting exceptiongroup
  Downloading exceptiongroup-1.0.1-py3-none-any.whl (12 kB)
Requirement already satisfied: typing_extensions in /usr/local/lib/python3.7/dist-packages (from cattrs&gt;=22.2-&gt;requests-cache-&gt;hca-ingest) (4.1.1)
Requirement already satisfied: idna&lt;3,&gt;=2.5 in /usr/local/lib/python3.7/dist-packages (from requests[security]-&gt;hca-ingest) (2.10)
Requirement already satisfied: chardet&lt;4,&gt;=3.0.2 in /usr/local/lib/python3.7/dist-packages (from requests[security]-&gt;hca-ingest) (3.0.4)
Collecting urllib3&gt;=1.25.5
  Downloading urllib3-1.25.11-py2.py3-none-any.whl (127 kB)
[K     |‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 127 kB 37.2 MB/s 
[?25hRequirement already satisfied: certifi&gt;=2017.4.17 in /usr/local/lib/python3.7/dist-packages (from requests[security]-&gt;hca-ingest) (2022.9.24)
Requirement already satisfied: six in /usr/local/lib/python3.7/dist-packages (from url-normalize&gt;=1.4-&gt;requests-cache-&gt;hca-ingest) (1.15.0)
Collecting pyOpenSSL&gt;=0.14
  Downloading pyOpenSSL-22.1.0-py3-none-any.whl (57 kB)
[K     |‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 57 kB 5.0 MB/s 
[?25hBuilding wheels for collected packages: hca-ingest, polling
  Building wheel for hca-ingest (setup.py) ... [?25l[?25hdone
  Created wheel for hca-ingest: filename=hca_ingest-2.6.0-py3-none-any.whl size=70596 sha256=114859a9f8d95b35d96ab061da4a47a702825e7a9a0015cfdcf7e06ac4300515
  Stored in directory: /root/.cache/pip/wheels/c2/8e/0c/4693dcbc7e2b550c87e3b89a41f0b2e4d98924bc7681c85846
  Building wheel for polling (setup.py) ... [?25l[?25hdone
  Created wheel for polling: filename=polling-0.3.2-py3-none-any.whl size=4129 sha256=3fb1d18a14a77ee5a6864cc4e989d673d80b8421e54621e759012f50d975858a
  Stored in directory: /root/.cache/pip/wheels/e5/3f/0c/54a03b715fce3176335c957ae94d7d0b2a918e89b1b195bace
Successfully built hca-ingest polling
Installing collected packages: urllib3, exceptiongroup, cryptography, url-normalize, pyOpenSSL, cattrs, xlsxwriter, requests-cache, polling, mergedeep, jsonref, hca-ingest
  Attempting uninstall: urllib3
    Found existing installation: urllib3 1.24.3
    Uninstalling urllib3-1.24.3:
      Successfully uninstalled urllib3-1.24.3
Successfully installed cattrs-22.2.0 cryptography-38.0.3 exceptiongroup-1.0.1 hca-ingest-2.6.0 jsonref-1.0.1 mergedeep-1.3.4 polling-0.3.2 pyOpenSSL-22.1.0 requests-cache-0.9.7 url-normalize-1.4.3 urllib3-1.25.11 xlsxwriter-3.0.3
</code></pre></div> </div> <h3 class="no_toc" id="load-libraries"> <a href="#load-libraries" class="anchor-heading" aria-labelledby="load-libraries"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Load libraries </h3> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">requests</span> <span class="k">as</span> <span class="n">rq</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">from</span> <span class="nn">hca_ingest.api.ingestapi</span> <span class="kn">import</span> <span class="n">IngestApi</span>
</code></pre></div> </div> <h3 class="no_toc" id="get-a-token"> <a href="#get-a-token" class="anchor-heading" aria-labelledby="get-a-token"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Get a token </h3> <p>In order to get a token, you need to log in to the ingest UI: https://staging.contribute.data.humancellatlas.org/. For the purpose of this notebook, we will be using staging. However, that can be change to prod (by deleting the first part of the domain) or to dev (by changing <code class="language-plaintext highlighter-rouge">staging</code> to <code class="language-plaintext highlighter-rouge">dev</code>) at any point in the process.</p> <p>If you are going to use any other environment, please remember to change the <code class="language-plaintext highlighter-rouge">environment</code> variable in the next section</p> <p>The steps to obtain the token are detailed in this guide: <a href="https://ebi-ait.github.io/hca-ebi-dev-team/operations_tasks/api_token.html">API tokens</a></p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">token</span> <span class="o">=</span> <span class="s">"Bearer &lt;paste_token_here&gt;"</span>
</code></pre></div> </div> <h3 class="no_toc" id="set-up-environment-and-global-variables"> <a href="#set-up-environment-and-global-variables" class="anchor-heading" aria-labelledby="set-up-environment-and-global-variables"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Set up environment and global variables </h3> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Environment-related set-up and global variables used across the notebook
</span><span class="n">accepted_environments</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">'develop'</span><span class="p">:</span> <span class="s">'.dev'</span><span class="p">,</span>
    <span class="s">'staging'</span><span class="p">:</span> <span class="s">'.staging'</span><span class="p">,</span>
    <span class="s">'production'</span><span class="p">:</span> <span class="s">''</span>
<span class="p">}</span>

<span class="n">environment</span> <span class="o">=</span> <span class="s">'staging'</span>  <span class="c1">#staging environment by default
</span>
<span class="c1"># Set up environment value for API's URL
</span><span class="k">try</span><span class="p">:</span>
  <span class="n">env_for_url</span> <span class="o">=</span> <span class="n">accepted_environments</span><span class="p">[</span><span class="n">environment</span><span class="p">]</span>
<span class="k">except</span> <span class="nb">KeyError</span><span class="p">:</span>
  <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Environment </span><span class="si">{</span><span class="n">environment</span><span class="si">}</span><span class="s"> not recognised. Defaulting to staging"</span><span class="p">)</span>
  <span class="n">env_for_url</span> <span class="o">=</span> <span class="n">accepted_environments</span><span class="p">[</span><span class="s">'staging'</span><span class="p">]</span>

<span class="n">base_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s">'https://api.ingest</span><span class="si">{</span><span class="n">env_for_url</span><span class="si">}</span><span class="s">.archive.data.humancellatlas.org'</span>

<span class="c1"># Set up API object
</span><span class="n">api</span> <span class="o">=</span> <span class="n">IngestApi</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">base_url</span><span class="p">)</span>
<span class="n">headers</span> <span class="o">=</span> <span class="n">api</span><span class="p">.</span><span class="n">set_token</span><span class="p">(</span><span class="n">token</span><span class="o">=</span><span class="n">token</span><span class="p">)</span>

</code></pre></div> </div> <h2 class="no_toc" id="create-a-project-1"> <a href="#create-a-project-1" class="anchor-heading" aria-labelledby="create-a-project-1"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Create a project </h2> <p>This block of code will be dedicated to creating a project within ingest. The following will be assumed:</p> <ul> <li>A JSON entity is available for use as the ‚Äúcontent‚Äù</li> </ul> <p>For the purpose of this notebook, everything will be performed in the staging environment. To perform this on other environments (e.g. prod), please update the <code class="language-plaintext highlighter-rouge">environment</code> variable to any of the values accepted in <code class="language-plaintext highlighter-rouge">accepted_environments</code></p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Load the project metadata entity
</span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">'example_project.json'</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
  <span class="n">project_content</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

<span class="n">ingest_project</span> <span class="o">=</span> <span class="n">api</span><span class="p">.</span><span class="n">create_project</span><span class="p">(</span><span class="n">submission_url</span><span class="o">=</span><span class="s">''</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">project_content</span><span class="p">)</span>

</code></pre></div> </div> <p>The returned object is the project as contained by ingest: this object contains the metadata that was submitted in the previous step, but also contains some extra, important metadata:</p> <ul> <li>uuid: Unique identifier for your project, generated randomly</li> <li>Management metadata: This metadata comprises metadata that will apply to your experiment, e.g. organs, species used, etc.</li> </ul> <p>We‚Äôre going to print the object and take a look</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ingest_project</span>
</code></pre></div> </div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{'content': {'describedBy': 'https://schema.staging.data.humancellatlas.org/type/project/17.0.0/project',
  'schema_type': 'project',
  'project_core': {'project_short_name': 'myCoolLabel',
   'project_title': 'Test_project_with_minimum_information',
   'project_description': 'This is a test project with minimum information for the programmatic submissions guide'},
  'contributors': [{'name': 'Enrique,,Ventura',
    'email': 'enrique@ebi.ac.uk',
    'institution': 'EMBL-EBI',
    'corresponding_contributor': True,
    'project_role': {'text': 'data curator',
     'ontology': 'EFO:0009737',
     'ontology_label': 'data curator'}}],
  'publications': [{'authors': ['Lorem IP', 'Sed UP'],
    'title': 'A combined approach for single-cell mRNA and intracellular protein expression analysis',
    'url': 'https://www.frontiersin.org/articles/10.3389/fcell.2020.00384/full',
    'official_hca_publication': False}],
  'funders': [{'grant_title': 'a cool grant',
    'grant_id': '000000000bp1',
    'organization': 'EMBL-EBI'}]},
 'submissionDate': '2022-11-09T17:36:29.253947Z',
 'updateDate': '2022-11-09T17:36:29.253947Z',
 'user': '5ece3464ec0680746267e784',
 'lastModifiedUser': '5ece3464ec0680746267e784',
 'type': 'Project',
 'uuid': {'uuid': 'e838a25f-8f52-4678-9744-6d650ca65374'},
 'events': [],
 'firstDcpVersion': '2022-11-09T17:36:29.253947Z',
 'dcpVersion': '2022-11-09T17:36:29.253947Z',
 'contentLastModified': '2022-11-09T17:36:29.246070Z',
 'accession': None,
 'validationState': 'Draft',
 'validationErrors': None,
 'graphValidationErrors': None,
 'isUpdate': False,
 'releaseDate': None,
 'accessionDate': None,
 'technology': None,
 'organ': None,
 'cellCount': None,
 'dataAccess': None,
 'identifyingOrganisms': None,
 'primaryWrangler': None,
 'secondaryWrangler': None,
 'wranglingState': None,
 'wranglingPriority': None,
 'wranglingNotes': None,
 'isInCatalogue': None,
 'cataloguedDate': None,
 'publicationsInfo': None,
 'dcpReleaseNumber': None,
 'projectLabels': None,
 'hasOpenSubmission': False,
 '_links': {'self': {'href': 'https://api.ingest.staging.archive.data.humancellatlas.org/projects/636be51d897ce65cad07c786'},
  'project': {'href': 'https://api.ingest.staging.archive.data.humancellatlas.org/projects/636be51d897ce65cad07c786',
   'title': 'A single project'},
  'validating': {'href': 'https://api.ingest.staging.archive.data.humancellatlas.org/projects/636be51d897ce65cad07c786/validatingEvent'},
  'bundleManifests': {'href': 'https://api.ingest.staging.archive.data.humancellatlas.org/projects/636be51d897ce65cad07c786/bundleManifests',
   'title': 'Access or create bundle manifests (describing which submitted contents went into which bundle in the datastore)'},
  'auditLogs': {'href': 'https://api.ingest.staging.archive.data.humancellatlas.org/projects/636be51d897ce65cad07c786/auditLogs'},
  'supplementaryFiles': {'href': 'https://api.ingest.staging.archive.data.humancellatlas.org/projects/636be51d897ce65cad07c786/supplementaryFiles'},
  'submissionEnvelopes': {'href': 'https://api.ingest.staging.archive.data.humancellatlas.org/projects/636be51d897ce65cad07c786/submissionEnvelopes',
   'title': 'Access or create new submission envelopes'},
  'submissionEnvelope': {'href': 'https://api.ingest.staging.archive.data.humancellatlas.org/projects/636be51d897ce65cad07c786/submissionEnvelope',
   'title': 'A single submission envelope'}}}
</code></pre></div> </div> <p>Everything looks correct, so we will save the identifier for our project (called the <code class="language-plaintext highlighter-rouge">uuid</code>) and store it in case we need to retrieve the project later.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Store project uuid
</span><span class="n">ingest_project_uuid</span> <span class="o">=</span> <span class="n">ingest_project</span><span class="p">[</span><span class="s">'uuid'</span><span class="p">][</span><span class="s">'uuid'</span><span class="p">]</span>
</code></pre></div> </div> <h3 class="no_toc" id="understanding-the-information-on-the-project"> <a href="#understanding-the-information-on-the-project" class="anchor-heading" aria-labelledby="understanding-the-information-on-the-project"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Understanding the information on the project </h3> <p>After printing the resulting <code class="language-plaintext highlighter-rouge">ingest_project</code>, you probably have noticed that there is much more meatadata than what was sent; for most entities, this is just system-generated and you don‚Äôt need to worry about it.</p> <p>However, for <code class="language-plaintext highlighter-rouge">project</code> metadata, we load some information regarding statuses and general-level metadata for different purposes (e.g. display in the <a href="https://www.ebi.ac.uk/humancellatlas/project-catalogue/">project catalogue</a>).</p> <p>This project-level metadata is explained in more detail in the <a href="https://ebi-ait.github.io/ingest-programmatic-submissions/docs/create_a_project/create_a_project.html">create a project</a> guideline associated with this notebook. For now, we will focus on the metadata that we should fill out:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">minimum_required_fields</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">'releaseDate'</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>          <span class="c1"># Date that you want your data to be released. If the data is to be released as soon as possible, or if data has already been released (e.g. in GEO) input today's date in format: YYYY-MM-DDT00:00:00Z (e.g. 2021-11-29T00:00:00Z)
</span>    <span class="s">'accessionDate'</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>        <span class="c1"># Same as above, but for accessioning in public archives.
</span>    <span class="s">'technology'</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>           <span class="c1"># Library preparation technology(ies) used in the experiment, ontologised. More below.
</span>    <span class="s">'organ'</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>                <span class="c1"># Organ(s) used in the experimnt, ontologised. More below
</span>    <span class="s">'cellCount'</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>            <span class="c1"># Estimated number of cells generated by this project.
</span>    <span class="s">'dataAccess'</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>           <span class="c1"># Type of data access, selected from a list of terms. For more detail, refer to readme.
</span>    <span class="s">'identifyingOrganisms'</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span> <span class="c1"># Organism that was used to generate the data, can be: Human, Mouse, or both.
</span>    <span class="s">'primaryWrangler'</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>      <span class="c1"># Person that is in charge of the project/submission: associated with a user.
</span>    <span class="s">'wranglingState'</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>       <span class="c1"># Status of the project. For a detailed list of accepted values, refer to readme.
</span>    <span class="s">'wranglingPriority'</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>    <span class="c1"># 1, 2, or 3. 1 is highest priority and 3 is lowest. Refer to readme for more information.
</span>    <span class="s">'wranglingNotes'</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>       <span class="c1">#¬†Extra notes associated with the project; feel free to input your own notes here.
</span>    <span class="s">'isInCatalogue'</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>        <span class="c1"># If the project is to be displayed in the catalogue, True, otherwise False
</span>    <span class="p">}</span>
</code></pre></div> </div> <h3 class="no_toc" id="adding-minimum-information"> <a href="#adding-minimum-information" class="anchor-heading" aria-labelledby="adding-minimum-information"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Adding minimum information </h3> <p>Now, we will be modifying the information on the list above, to make sure we enter the minimum amount of metadata that the project should contain. We‚Äôre going to divide the fields in 2 types:</p> <ul> <li><strong>Ontologised</strong>: fields that are validated against the <a href="https://ontology.archive.data.humancellatlas.org/index">HCA ontology</a>.</li> <li><strong>Other</strong>: Fields that have are not ontologised and that are validated against other premises.</li> </ul> <p>We‚Äôre going to start with the ontologised fields.</p> <h4 class="no_toc" id="ontologised-fields"> <a href="#ontologised-fields" class="anchor-heading" aria-labelledby="ontologised-fields"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Ontologised fields </h4> <p>These terms are called ‚Äúontologised‚Äù because they are validated against a set of restrictions defined both in our validation rules and enforced in the ontologies themselves; for example, <code class="language-plaintext highlighter-rouge">organ</code> validates that the term used as an input is validated as a child term, only with relationship <code class="language-plaintext highlighter-rouge">subclassOf</code>, of the term <code class="language-plaintext highlighter-rouge">anatomical structure</code>(<a href="https://ontology.archive.data.humancellatlas.org/ontologies/hcao/terms?iri=http%3A%2F%2Fpurl.obolibrary.org%2Fobo%2FUBERON_0000061">UBERON:0000061</a>). Detailed information on the restrictions can be found in the readme file.</p> <p>In this category, we have 2 fields:</p> <ul> <li>organ: A list of the organs used in this experiment; for this notebook, we‚Äôre going to use the terms ‚Äúlung‚Äù(<a href="https://ontology.archive.data.humancellatlas.org/ontologies/hcao/terms?iri=http%3A%2F%2Fpurl.obolibrary.org%2Fobo%2FUBERON_0002048">UBERON:0002048</a>) and ‚Äúheart‚Äù(<a href="https://ontology.archive.data.humancellatlas.org/ontologies/hcao/terms?iri=http%3A%2F%2Fpurl.obolibrary.org%2Fobo%2FUBERON_0000948">UBERON:0000948</a>).</li> <li>technology: A list of the library preparation technologies used in this experiment; for this notebook, we‚Äôre going to use the terms <code class="language-plaintext highlighter-rouge">10x 3' v2</code>(<a href="https://ontology.archive.data.humancellatlas.org/ontologies/efo/terms?iri=http%3A%2F%2Fwww.ebi.ac.uk%2Fefo%2FEFO_0009899">EFO:0009899</a>) and <code class="language-plaintext highlighter-rouge">10x 3' v3</code>(<a href="https://ontology.archive.data.humancellatlas.org/ontologies/efo/terms?iri=http%3A%2F%2Fwww.ebi.ac.uk%2Fefo%2FEFO_0009922">EFO:0009922</a>). This field also accepts free text in case there is no ontology for the term just yet; we are also going to add an entry for this</li> </ul> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Set up organ
</span><span class="n">organ</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">"ontologies"</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="s">"text"</span><span class="p">:</span> <span class="s">"lung"</span><span class="p">,</span>                 <span class="c1"># Text field, free string that allows the user to introduce a more exact definition of the term if not available in the ontology
</span>        <span class="s">"ontology"</span><span class="p">:</span> <span class="s">"UBERON:0002048"</span><span class="p">,</span>   <span class="c1"># Unique identifier for the ontology term, in the form of &lt;ontology&gt;:&lt;ID&gt;
</span>        <span class="s">"ontology_label"</span><span class="p">:</span> <span class="s">"lung"</span>        <span class="c1">#¬†Text field, must exactly match the label provided in the ontology, case sensitive.
</span>      <span class="p">},</span>
      <span class="p">{</span>
        <span class="s">"text"</span><span class="p">:</span> <span class="s">"heart"</span><span class="p">,</span>
        <span class="s">"ontology"</span><span class="p">:</span> <span class="s">"UBERON:0000948"</span><span class="p">,</span>
        <span class="s">"ontology_label"</span><span class="p">:</span> <span class="s">"heart"</span>
      <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>

<span class="c1"># Set up technology
</span><span class="n">technology</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">"ontologies"</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="s">"text"</span><span class="p">:</span> <span class="s">"10x 3' v2"</span><span class="p">,</span>
        <span class="s">"ontology"</span><span class="p">:</span> <span class="s">"EFO:0009899"</span><span class="p">,</span>
        <span class="s">"ontology_label"</span><span class="p">:</span> <span class="s">"10x 3' v2"</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="s">"text"</span><span class="p">:</span> <span class="s">"10x 3' v3"</span><span class="p">,</span>
        <span class="s">"ontology"</span><span class="p">:</span> <span class="s">"EFO:0009922"</span><span class="p">,</span>
        <span class="s">"ontology_label"</span><span class="p">:</span> <span class="s">"10x 3' v3"</span>
      <span class="p">}</span>
    <span class="p">],</span>
    <span class="s">"others"</span><span class="p">:</span> <span class="p">[</span>
        <span class="s">"Mysupercoollibrarypreptechnology"</span>  <span class="c1"># Free text field to introduce as many terms as you want that couldn't be found in the ontology
</span>    <span class="p">]</span>
<span class="p">}</span>

<span class="c1"># pass the values to our variable
</span><span class="n">minimum_required_fields</span><span class="p">[</span><span class="s">'organ'</span><span class="p">]</span> <span class="o">=</span> <span class="n">organ</span>
<span class="n">minimum_required_fields</span><span class="p">[</span><span class="s">'technology'</span><span class="p">]</span> <span class="o">=</span> <span class="n">technology</span>
</code></pre></div> </div> <h4 class="no_toc" id="other-fields"> <a href="#other-fields" class="anchor-heading" aria-labelledby="other-fields"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Other fields </h4> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Dates
# Dates must follow the following format: YYYY-MM-DDThh:mm:ssZ
</span><span class="n">minimum_required_fields</span><span class="p">[</span><span class="s">'releaseDate'</span><span class="p">]</span> <span class="o">=</span> <span class="s">"2022-08-30T00:00:00Z"</span>
<span class="n">minimum_required_fields</span><span class="p">[</span><span class="s">'accessionDate'</span><span class="p">]</span> <span class="o">=</span> <span class="s">"2022-08-30T00:00:00Z"</span>

<span class="c1"># Enum values
# Set of values accepted are predetermined, depending on the field. 
# For the full list of values, please refer to the readme
</span><span class="n">minimum_required_fields</span><span class="p">[</span><span class="s">'dataAccess'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                                          <span class="s">"type"</span><span class="p">:</span> <span class="s">"All fully open"</span><span class="p">,</span>
                                          <span class="s">"notes"</span><span class="p">:</span> <span class="s">"Can be released publicly! :D"</span>
                                        <span class="p">}</span>
<span class="n">minimum_required_fields</span><span class="p">[</span><span class="s">'identifyingOrganisms'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s">"Human"</span><span class="p">,</span> <span class="s">"Mouse"</span><span class="p">,</span> <span class="s">"Other"</span><span class="p">]</span>
<span class="n">minimum_required_fields</span><span class="p">[</span><span class="s">'wranglingPriority'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># Very important project!
</span><span class="n">minimum_required_fields</span><span class="p">[</span><span class="s">'wranglingState'</span><span class="p">]</span> <span class="o">=</span> <span class="s">"Eligible"</span>

<span class="c1"># Simple values
# Set of fields that have a simple value; it may be a free string, an integer or a boolean
</span><span class="n">minimum_required_fields</span><span class="p">[</span><span class="s">'cellCount'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">17500</span>
<span class="n">minimum_required_fields</span><span class="p">[</span><span class="s">'primaryWrangler'</span><span class="p">]</span> <span class="o">=</span> <span class="n">ingest_project</span><span class="p">[</span><span class="s">'user'</span><span class="p">]</span> <span class="c1"># User ID is required in this field.
</span><span class="n">minimum_required_fields</span><span class="p">[</span><span class="s">'wranglingNotes'</span><span class="p">]</span> <span class="o">=</span> <span class="s">"This is an awesome project and I will finish it soon"</span>
<span class="n">minimum_required_fields</span><span class="p">[</span><span class="s">'isInCatalogue'</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span> <span class="c1"># We want the project to be displayed in the project catalogue
</span></code></pre></div> </div> <h2 class="no_toc" id="updating-project-with-missing-information"> <a href="#updating-project-with-missing-information" class="anchor-heading" aria-labelledby="updating-project-with-missing-information"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Updating project with missing information </h2> <p>Now that we understand the metadata that we are handling, and that we have filled in the missing bits necessary for a minimum information project, we will update the project with the values that we have been gathering.</p> <p>Once we have the content that we have to update, the update itself is pretty easy!</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Retrieve project URL to update
</span><span class="n">ingest_project_url</span> <span class="o">=</span> <span class="n">ingest_project</span><span class="p">[</span><span class="s">'_links'</span><span class="p">][</span><span class="s">'self'</span><span class="p">][</span><span class="s">'href'</span><span class="p">]</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">api</span><span class="p">.</span><span class="n">patch</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">ingest_project_url</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">minimum_required_fields</span><span class="p">)</span>

<span class="n">updated_ingest_project</span> <span class="o">=</span> <span class="n">response</span><span class="p">.</span><span class="n">json</span><span class="p">()</span>
</code></pre></div> </div> <p>Let‚Äôs print the project and check if the changes have made it through!</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">updated_ingest_project</span>
</code></pre></div> </div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{'content': {'describedBy': 'https://schema.staging.data.humancellatlas.org/type/project/17.0.0/project',
  'schema_type': 'project',
  'project_core': {'project_short_name': 'myCoolLabel',
   'project_title': 'Test_project_with_minimum_information',
   'project_description': 'This is a test project with minimum information for the programmatic submissions guide'},
  'contributors': [{'name': 'Enrique,,Ventura',
    'email': 'enrique@ebi.ac.uk',
    'institution': 'EMBL-EBI',
    'corresponding_contributor': True,
    'project_role': {'text': 'data curator',
     'ontology': 'EFO:0009737',
     'ontology_label': 'data curator'}}],
  'publications': [{'authors': ['Lorem IP', 'Sed UP'],
    'title': 'A combined approach for single-cell mRNA and intracellular protein expression analysis',
    'url': 'https://www.frontiersin.org/articles/10.3389/fcell.2020.00384/full',
    'official_hca_publication': False}],
  'funders': [{'grant_title': 'a cool grant',
    'grant_id': '000000000bp1',
    'organization': 'EMBL-EBI'}]},
 'submissionDate': '2022-11-09T17:36:29.253Z',
 'updateDate': '2022-11-09T17:37:57.227484Z',
 'user': '5ece3464ec0680746267e784',
 'lastModifiedUser': '5ece3464ec0680746267e784',
 'type': 'Project',
 'uuid': {'uuid': 'e838a25f-8f52-4678-9744-6d650ca65374'},
 'events': [],
 'firstDcpVersion': '2022-11-09T17:36:29.253Z',
 'dcpVersion': '2022-11-09T17:36:29.253Z',
 'contentLastModified': '2022-11-09T17:36:29.246Z',
 'accession': None,
 'validationState': 'Valid',
 'validationErrors': [],
 'graphValidationErrors': None,
 'isUpdate': False,
 'releaseDate': '2022-08-30T00:00:00Z',
 'accessionDate': '2022-08-30T00:00:00Z',
 'technology': {'ontologies': [{'text': "10x 3' v2",
    'ontology': 'EFO:0009899',
    'ontology_label': "10x 3' v2"},
   {'text': "10x 3' v3",
    'ontology': 'EFO:0009922',
    'ontology_label': "10x 3' v3"}],
  'others': ['Mysupercoollibrarypreptechnology']},
 'organ': {'ontologies': [{'text': 'lung',
    'ontology': 'UBERON:0002048',
    'ontology_label': 'lung'},
   {'text': 'heart',
    'ontology': 'UBERON:0000948',
    'ontology_label': 'heart'}]},
 'cellCount': 17500,
 'dataAccess': {'type': 'All fully open',
  'notes': 'Can be released publicly! :D'},
 'identifyingOrganisms': ['Human', 'Mouse', 'Other'],
 'primaryWrangler': '5ece3464ec0680746267e784',
 'secondaryWrangler': None,
 'wranglingState': 'Eligible',
 'wranglingPriority': 1,
 'wranglingNotes': 'This is an awesome project and I will finish it soon',
 'isInCatalogue': True,
 'cataloguedDate': '2022-11-09T17:37:57.207027Z',
 'publicationsInfo': None,
 'dcpReleaseNumber': None,
 'projectLabels': None,
 'hasOpenSubmission': False,
 '_links': {'self': {'href': 'https://api.ingest.staging.archive.data.humancellatlas.org/projects/636be51d897ce65cad07c786'},
  'project': {'href': 'https://api.ingest.staging.archive.data.humancellatlas.org/projects/636be51d897ce65cad07c786',
   'title': 'A single project'},
  'processing': {'href': 'https://api.ingest.staging.archive.data.humancellatlas.org/projects/636be51d897ce65cad07c786/processingEvent'},
  'draft': {'href': 'https://api.ingest.staging.archive.data.humancellatlas.org/projects/636be51d897ce65cad07c786/draftEvent'},
  'bundleManifests': {'href': 'https://api.ingest.staging.archive.data.humancellatlas.org/projects/636be51d897ce65cad07c786/bundleManifests',
   'title': 'Access or create bundle manifests (describing which submitted contents went into which bundle in the datastore)'},
  'auditLogs': {'href': 'https://api.ingest.staging.archive.data.humancellatlas.org/projects/636be51d897ce65cad07c786/auditLogs'},
  'supplementaryFiles': {'href': 'https://api.ingest.staging.archive.data.humancellatlas.org/projects/636be51d897ce65cad07c786/supplementaryFiles'},
  'submissionEnvelopes': {'href': 'https://api.ingest.staging.archive.data.humancellatlas.org/projects/636be51d897ce65cad07c786/submissionEnvelopes',
   'title': 'Access or create new submission envelopes'},
  'submissionEnvelope': {'href': 'https://api.ingest.staging.archive.data.humancellatlas.org/projects/636be51d897ce65cad07c786/submissionEnvelope',
   'title': 'A single submission envelope'}}}
</code></pre></div> </div> <p>And we have our project, updated, with the minimum required metadata!</p> <h2 class="no_toc" id="retrieve-a-project"> <a href="#retrieve-a-project" class="anchor-heading" aria-labelledby="retrieve-a-project"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Retrieve a project </h2> <p>Once we have created a project with minimum information, we may want to retrieve the project to do further things with it (Add more metadata, check status, etc). In order to do this, we are going to use one of the many functions that we have available to retrieve a project:</p> <ul> <li><code class="language-plaintext highlighter-rouge">IngestApi.get_project_by_uuid</code>: Retrieves a single project with a UUID</li> </ul> <p>But there are other functions available, in case you don‚Äôt have the UUID at hand or can‚Äôt remember, listed below:</p> <details> <summary>Functions to search for projects</summary> <ul> <li>.get_user_projects: Retrieve all the projects associated with your user (Requires token to be set)</li> <li>.get_project_by_id: Retrieve a project with the MongoDB ID provided</li> </ul> </details> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ingest_project</span> <span class="o">=</span> <span class="n">api</span><span class="p">.</span><span class="n">get_project_by_uuid</span><span class="p">(</span><span class="n">ingest_project_uuid</span><span class="p">)</span>
</code></pre></div> </div> <p>Let‚Äôs ensure we have retrieved our project correctly:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ingest_project</span>
</code></pre></div> </div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{'content': {'describedBy': 'https://schema.staging.data.humancellatlas.org/type/project/17.0.0/project',
  'schema_type': 'project',
  'project_core': {'project_short_name': 'myCoolLabel',
   'project_title': 'Test_project_with_minimum_information',
   'project_description': 'This is a test project with minimum information for the programmatic submissions guide'},
  'contributors': [{'name': 'Enrique,,Ventura',
    'email': 'enrique@ebi.ac.uk',
    'institution': 'EMBL-EBI',
    'corresponding_contributor': True,
    'project_role': {'text': 'data curator',
     'ontology': 'EFO:0009737',
     'ontology_label': 'data curator'}}],
  'publications': [{'authors': ['Lorem IP', 'Sed UP'],
    'title': 'A combined approach for single-cell mRNA and intracellular protein expression analysis',
    'url': 'https://www.frontiersin.org/articles/10.3389/fcell.2020.00384/full',
    'official_hca_publication': False}],
  'funders': [{'grant_title': 'a cool grant',
    'grant_id': '000000000bp1',
    'organization': 'EMBL-EBI'}]},
 'submissionDate': '2022-11-09T17:36:29.253Z',
 'updateDate': '2022-11-09T17:37:57.227Z',
 'user': '5ece3464ec0680746267e784',
 'lastModifiedUser': '5ece3464ec0680746267e784',
 'type': 'Project',
 'uuid': {'uuid': 'e838a25f-8f52-4678-9744-6d650ca65374'},
 'events': [],
 'firstDcpVersion': '2022-11-09T17:36:29.253Z',
 'dcpVersion': '2022-11-09T17:36:29.253Z',
 'contentLastModified': '2022-11-09T17:36:29.246Z',
 'accession': None,
 'validationState': 'Valid',
 'validationErrors': [],
 'graphValidationErrors': None,
 'isUpdate': False,
 'releaseDate': '2022-08-30T00:00:00Z',
 'accessionDate': '2022-08-30T00:00:00Z',
 'technology': {'ontologies': [{'text': "10x 3' v2",
    'ontology': 'EFO:0009899',
    'ontology_label': "10x 3' v2"},
   {'text': "10x 3' v3",
    'ontology': 'EFO:0009922',
    'ontology_label': "10x 3' v3"}],
  'others': ['Mysupercoollibrarypreptechnology']},
 'organ': {'ontologies': [{'text': 'lung',
    'ontology': 'UBERON:0002048',
    'ontology_label': 'lung'},
   {'text': 'heart',
    'ontology': 'UBERON:0000948',
    'ontology_label': 'heart'}]},
 'cellCount': 17500,
 'dataAccess': {'type': 'All fully open',
  'notes': 'Can be released publicly! :D'},
 'identifyingOrganisms': ['Human', 'Mouse', 'Other'],
 'primaryWrangler': '5ece3464ec0680746267e784',
 'secondaryWrangler': None,
 'wranglingState': 'Eligible',
 'wranglingPriority': 1,
 'wranglingNotes': 'This is an awesome project and I will finish it soon',
 'isInCatalogue': True,
 'cataloguedDate': '2022-11-09T17:37:57.207Z',
 'publicationsInfo': None,
 'dcpReleaseNumber': None,
 'projectLabels': None,
 'hasOpenSubmission': False,
 '_links': {'self': {'href': 'https://api.ingest.staging.archive.data.humancellatlas.org/projects/636be51d897ce65cad07c786'},
  'project': {'href': 'https://api.ingest.staging.archive.data.humancellatlas.org/projects/636be51d897ce65cad07c786',
   'title': 'A single project'},
  'processing': {'href': 'https://api.ingest.staging.archive.data.humancellatlas.org/projects/636be51d897ce65cad07c786/processingEvent'},
  'draft': {'href': 'https://api.ingest.staging.archive.data.humancellatlas.org/projects/636be51d897ce65cad07c786/draftEvent'},
  'bundleManifests': {'href': 'https://api.ingest.staging.archive.data.humancellatlas.org/projects/636be51d897ce65cad07c786/bundleManifests',
   'title': 'Access or create bundle manifests (describing which submitted contents went into which bundle in the datastore)'},
  'auditLogs': {'href': 'https://api.ingest.staging.archive.data.humancellatlas.org/projects/636be51d897ce65cad07c786/auditLogs'},
  'supplementaryFiles': {'href': 'https://api.ingest.staging.archive.data.humancellatlas.org/projects/636be51d897ce65cad07c786/supplementaryFiles'},
  'submissionEnvelopes': {'href': 'https://api.ingest.staging.archive.data.humancellatlas.org/projects/636be51d897ce65cad07c786/submissionEnvelopes',
   'title': 'Access or create new submission envelopes'},
  'submissionEnvelope': {'href': 'https://api.ingest.staging.archive.data.humancellatlas.org/projects/636be51d897ce65cad07c786/submissionEnvelope',
   'title': 'A single submission envelope'}}}
</code></pre></div> </div> <h3 class="no_toc" id="check-status-of-a-project"> <a href="#check-status-of-a-project" class="anchor-heading" aria-labelledby="check-status-of-a-project"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Check status of a project </h3> <p>When a project (or any piece of metadata) is updated to ingest, it gets validated, the <code class="language-plaintext highlighter-rouge">content</code> being validated against the schema it is pointing to (on the <code class="language-plaintext highlighter-rouge">describedBy</code> field), and in the case of the project, the base fields validating against other set of rules.</p> <p>The ingest service has the ability to provide with a full report of these validation events, including the status of the entity and the error messages.</p> <p>On this section, we will focus on retrieving the errors (currently none) of the project we just uploaded and we will update the project to artificially produce a couple of errors. We will then retrieve the project again and check on the errors, but for a detailed explanation of each type of error, please refer to the Readme file.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Print validation errors
</span><span class="n">validation_errors</span> <span class="o">=</span> <span class="n">ingest_project</span><span class="p">[</span><span class="s">'validationErrors'</span><span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Validation errors: </span><span class="si">{</span><span class="n">validation_errors</span> <span class="k">if</span> <span class="n">validation_errors</span> <span class="k">else</span> <span class="bp">None</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>

<span class="c1"># Print validation status
</span><span class="n">validation_status</span> <span class="o">=</span> <span class="n">ingest_project</span><span class="p">[</span><span class="s">'validationState'</span><span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Validation status: </span><span class="si">{</span><span class="n">validation_status</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
</code></pre></div> </div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Validation errors: None
Validation status: Valid
</code></pre></div> </div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">non_valid_content</span> <span class="o">=</span> <span class="n">ingest_project</span><span class="p">[</span><span class="s">'content'</span><span class="p">]</span>
<span class="n">non_valid_content</span><span class="p">[</span><span class="s">'estimated_cell_count'</span><span class="p">]</span> <span class="o">=</span> <span class="s">'17500'</span>             <span class="c1"># Cell count should always be an integer
</span><span class="n">non_valid_content</span><span class="p">[</span><span class="s">'insdc_project_accessions'</span><span class="p">]</span> <span class="o">=</span>  <span class="p">[</span>              <span class="c1"># INSDC project accessions:
</span>                                      <span class="s">'GSE7777777'</span><span class="p">,</span>   <span class="c1"># SHOULD NOT be a GEO series accession
</span>                                      <span class="s">'SRP000000'</span><span class="p">,</span>    <span class="c1"># SHOULD follow SRPXXXXXX format
</span>                                      <span class="s">''</span><span class="p">,</span>             <span class="c1"># SHOULD NOT be an empty string
</span>                                      <span class="mi">347289347</span>       <span class="c1"># SHOULD NOT be a numer
</span>                                      <span class="p">]</span>

<span class="n">non_valid_values</span> <span class="o">=</span>  <span class="p">{</span>    
                      <span class="s">"content"</span> <span class="p">:</span> <span class="n">non_valid_content</span>   <span class="c1"># Patching "content" field
</span>                    <span class="p">}</span> 

<span class="c1"># Patch the non_valid content into the project content
</span><span class="n">response</span> <span class="o">=</span> <span class="n">api</span><span class="p">.</span><span class="n">patch</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">ingest_project_url</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">non_valid_values</span><span class="p">)</span>
</code></pre></div> </div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">response</span><span class="p">.</span><span class="n">json</span><span class="p">()</span>
</code></pre></div> </div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{'content': {'describedBy': 'https://schema.staging.data.humancellatlas.org/type/project/17.0.0/project',
  'schema_type': 'project',
  'project_core': {'project_short_name': 'myCoolLabel',
   'project_title': 'Test_project_with_minimum_information',
   'project_description': 'This is a test project with minimum information for the programmatic submissions guide'},
  'contributors': [{'name': 'Enrique,,Ventura',
    'email': 'enrique@ebi.ac.uk',
    'institution': 'EMBL-EBI',
    'corresponding_contributor': True,
    'project_role': {'text': 'data curator',
     'ontology': 'EFO:0009737',
     'ontology_label': 'data curator'}}],
  'publications': [{'authors': ['Lorem IP', 'Sed UP'],
    'title': 'A combined approach for single-cell mRNA and intracellular protein expression analysis',
    'url': 'https://www.frontiersin.org/articles/10.3389/fcell.2020.00384/full',
    'official_hca_publication': False}],
  'funders': [{'grant_title': 'a cool grant',
    'grant_id': '000000000bp1',
    'organization': 'EMBL-EBI'}],
  'estimated_cell_count': '17500',
  'insdc_project_accessions': ['GSE7777777', 'SRP000000', '', 347289347]},
 'submissionDate': '2022-11-09T17:36:29.253Z',
 'updateDate': '2022-11-09T17:38:35.057769Z',
 'user': '5ece3464ec0680746267e784',
 'lastModifiedUser': '5ece3464ec0680746267e784',
 'type': 'Project',
 'uuid': {'uuid': 'e838a25f-8f52-4678-9744-6d650ca65374'},
 'events': [],
 'firstDcpVersion': '2022-11-09T17:36:29.253Z',
 'dcpVersion': '2022-11-09T17:38:35.057205Z',
 'contentLastModified': '2022-11-09T17:38:35.057205Z',
 'accession': None,
 'validationState': 'Valid',
 'validationErrors': [],
 'graphValidationErrors': None,
 'isUpdate': False,
 'releaseDate': '2022-08-30T00:00:00Z',
 'accessionDate': '2022-08-30T00:00:00Z',
 'technology': {'ontologies': [{'text': "10x 3' v2",
    'ontology': 'EFO:0009899',
    'ontology_label': "10x 3' v2"},
   {'text': "10x 3' v3",
    'ontology': 'EFO:0009922',
    'ontology_label': "10x 3' v3"}],
  'others': ['Mysupercoollibrarypreptechnology']},
 'organ': {'ontologies': [{'text': 'lung',
    'ontology': 'UBERON:0002048',
    'ontology_label': 'lung'},
   {'text': 'heart',
    'ontology': 'UBERON:0000948',
    'ontology_label': 'heart'}]},
 'cellCount': 17500,
 'dataAccess': {'type': 'All fully open',
  'notes': 'Can be released publicly! :D'},
 'identifyingOrganisms': ['Human', 'Mouse', 'Other'],
 'primaryWrangler': '5ece3464ec0680746267e784',
 'secondaryWrangler': None,
 'wranglingState': None,
 'wranglingPriority': 1,
 'wranglingNotes': 'This is an awesome project and I will finish it soon',
 'isInCatalogue': True,
 'cataloguedDate': '2022-11-09T17:37:57.207Z',
 'publicationsInfo': None,
 'dcpReleaseNumber': None,
 'projectLabels': None,
 'hasOpenSubmission': False,
 '_links': {'self': {'href': 'https://api.ingest.staging.archive.data.humancellatlas.org/projects/636be51d897ce65cad07c786'},
  'project': {'href': 'https://api.ingest.staging.archive.data.humancellatlas.org/projects/636be51d897ce65cad07c786',
   'title': 'A single project'},
  'processing': {'href': 'https://api.ingest.staging.archive.data.humancellatlas.org/projects/636be51d897ce65cad07c786/processingEvent'},
  'draft': {'href': 'https://api.ingest.staging.archive.data.humancellatlas.org/projects/636be51d897ce65cad07c786/draftEvent'},
  'bundleManifests': {'href': 'https://api.ingest.staging.archive.data.humancellatlas.org/projects/636be51d897ce65cad07c786/bundleManifests',
   'title': 'Access or create bundle manifests (describing which submitted contents went into which bundle in the datastore)'},
  'auditLogs': {'href': 'https://api.ingest.staging.archive.data.humancellatlas.org/projects/636be51d897ce65cad07c786/auditLogs'},
  'supplementaryFiles': {'href': 'https://api.ingest.staging.archive.data.humancellatlas.org/projects/636be51d897ce65cad07c786/supplementaryFiles'},
  'submissionEnvelopes': {'href': 'https://api.ingest.staging.archive.data.humancellatlas.org/projects/636be51d897ce65cad07c786/submissionEnvelopes',
   'title': 'Access or create new submission envelopes'},
  'submissionEnvelope': {'href': 'https://api.ingest.staging.archive.data.humancellatlas.org/projects/636be51d897ce65cad07c786/submissionEnvelope',
   'title': 'A single submission envelope'}}}
</code></pre></div> </div> <p>After patching the project with invalid values, let‚Äôs repeat the check we did previously.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ingest_project</span> <span class="o">=</span> <span class="n">api</span><span class="p">.</span><span class="n">get_project_by_uuid</span><span class="p">(</span><span class="n">ingest_project_uuid</span><span class="p">)</span>
<span class="c1"># Print validation errors
</span><span class="n">validation_errors</span> <span class="o">=</span> <span class="n">ingest_project</span><span class="p">[</span><span class="s">'validationErrors'</span><span class="p">]</span>
<span class="n">newline</span> <span class="o">=</span> <span class="s">'</span><span class="se">\n</span><span class="s">'</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Validation errors: </span><span class="si">{</span><span class="n">validation_errors</span> <span class="k">if</span> <span class="n">validation_errors</span> <span class="k">else</span> <span class="bp">None</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>

<span class="c1"># Print validation status
</span><span class="n">validation_status</span> <span class="o">=</span> <span class="n">ingest_project</span><span class="p">[</span><span class="s">'validationState'</span><span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Validation status: </span><span class="si">{</span><span class="n">validation_status</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
</code></pre></div> </div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Validation errors: [{'errorType': 'METADATA_ERROR', 'message': 'should match pattern "^[D|E|S]RP[0-9]+$"', 'userFriendlyMessage': 'should match pattern "^[D|E|S]RP[0-9]+$" at .insdc_project_accessions[0]', 'absoluteDataPath': '.insdc_project_accessions[0]'}, {'errorType': 'METADATA_ERROR', 'message': 'should match pattern "^[D|E|S]RP[0-9]+$"', 'userFriendlyMessage': 'should match pattern "^[D|E|S]RP[0-9]+$" at .insdc_project_accessions[2]', 'absoluteDataPath': '.insdc_project_accessions[2]'}, {'errorType': 'METADATA_ERROR', 'message': 'should be string', 'userFriendlyMessage': 'should be string at .insdc_project_accessions[3]', 'absoluteDataPath': '.insdc_project_accessions[3]'}, {'errorType': 'METADATA_ERROR', 'message': 'should be integer', 'userFriendlyMessage': 'should be integer at .estimated_cell_count', 'absoluteDataPath': '.estimated_cell_count'}]
Validation status: Invalid
</code></pre></div> </div> <p>As we can see, this time it has returned 2 things:</p> <ul> <li>A set of errors, comprised in a list that details the errors, from type to message.</li> <li>Validation status: invalid, indicating that the validation went wrong.</li> </ul> <p>For detailed information on how to understand the errors, please proceed to the ‚Äúreadme.md‚Äù file.</p> <h2 class="no_toc" id="delete-a-project"> <a href="#delete-a-project" class="anchor-heading" aria-labelledby="delete-a-project"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Delete a project </h2> <p>Projects in our database can be deleted. While we do not advise to delete projects once they have been published in the data portal (<code class="language-plaintext highlighter-rouge">uuid</code> identifiers are important for updates), at any point before finishing the submission (Later in the notebook), any metadata entity can be deleted, including projects.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Delete ingest project and check everything went correctly
</span><span class="n">response</span> <span class="o">=</span> <span class="n">api</span><span class="p">.</span><span class="n">delete</span><span class="p">(</span><span class="n">ingest_project_url</span><span class="p">)</span>

<span class="k">assert</span> <span class="n">response</span><span class="p">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">204</span>
</code></pre></div> </div> <p>If the status code of the response is 204, the project has been deleted!</p> <h1 class="no_toc" id="addendum"> <a href="#addendum" class="anchor-heading" aria-labelledby="addendum"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Addendum </h1> <h2 class="no_toc" id="updating-projects"> <a href="#updating-projects" class="anchor-heading" aria-labelledby="updating-projects"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Updating projects </h2> <h3 class="no_toc" id="deleting-a-fieldreplacing-all-values"> <a href="#deleting-a-fieldreplacing-all-values" class="anchor-heading" aria-labelledby="deleting-a-fieldreplacing-all-values"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Deleting a field/Replacing all values </h3> <p>Deleting a field requires a slightly different sort of operation; up until now, we have used <code class="language-plaintext highlighter-rouge">patch</code> to address field modifications. However, if we want to delete a field or replace all values, we would need to delete the field from the content, and then PUT the whole content of the project entity to the project URL.</p> <p>This operation will completely replace the older entry with the new one; using the old one as a template ensures critical fields (e.g. <code class="language-plaintext highlighter-rouge">uuid</code>) get preserved over this operation.</p> <h3 class="no_toc" id="adding-new-fields"> <a href="#adding-new-fields" class="anchor-heading" aria-labelledby="adding-new-fields"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Adding new fields </h3> <p>When adding new fields, considering the type of field that is going to be added is essential; nested properties and arrays can‚Äôt be just modified through a <code class="language-plaintext highlighter-rouge">patch</code> operation, they need the document to be partially (or entirely) replaced</p> <p>In this notebook, we are going to add 2 fields:</p> <ul> <li>A completely new field, available in the schema, <code class="language-plaintext highlighter-rouge">insdc_project_accessions</code></li> <li>A new publication that we want associated to this project, without deleting the already existing one.</li> </ul> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Adding the INSDC project accession
</span><span class="n">response</span> <span class="o">=</span> <span class="n">api</span><span class="p">.</span><span class="n">patch</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">ingest_project_url</span><span class="p">,</span> <span class="n">patch</span><span class="o">=</span><span class="p">{</span><span class="s">"content"</span><span class="p">:</span> <span class="p">{</span><span class="s">"insdc_project_accessions"</span><span class="p">:</span> <span class="p">[</span><span class="s">"SRP000000"</span><span class="p">]}})</span>
<span class="k">assert</span> <span class="n">response</span><span class="p">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span>
<span class="n">updated_project</span> <span class="o">=</span> <span class="n">api</span><span class="p">.</span><span class="n">get_project_by_uuid</span><span class="p">(</span><span class="n">ingest_project_uuid</span><span class="p">)</span>

<span class="c1"># Let's print the project and ensure the modification has gone through!
</span><span class="n">updated_project</span>
</code></pre></div> </div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{'content': {'insdc_project_accessions': ['SRP000000']},
 'submissionDate': '2022-08-31T14:05:37.625Z',
 'updateDate': '2022-08-31T14:07:18.255Z',
 'user': '5ece3464ec0680746267e784',
 'lastModifiedUser': '5ece3464ec0680746267e784',
 'type': 'Project',
 'uuid': {'uuid': '019b3b05-903b-4b85-bdae-1e10589ccd06'},
 'events': [],
 'firstDcpVersion': '2022-08-31T14:05:37.625Z',
 'dcpVersion': '2022-08-31T14:07:18.252Z',
 'contentLastModified': '2022-08-31T14:07:18.252Z',
 'accession': None,
 'validationState': 'Draft',
 'validationErrors': [],
 'graphValidationErrors': None,
 'isUpdate': False,
 'releaseDate': '2022-08-30T00:00:00Z',
 'accessionDate': '2022-08-30T00:00:00Z',
 'technology': {'ontologies': [{'text': "10x 3' v2",
    'ontology': 'EFO:0009899',
    'ontology_label': "10x 3' v2"},
   {'text': "10x 3' v3",
    'ontology': 'EFO:0009922',
    'ontology_label': "10x 3' v3"}],
  'others': ['Mysupercoollibrarypreptechnology']},
 'organ': {'ontologies': [{'text': 'lung',
    'ontology': 'UBERON:0002048',
    'ontology_label': 'lung'},
   {'text': 'heart',
    'ontology': 'UBERON:0000948',
    'ontology_label': 'heart'}]},
 'cellCount': 17500,
 'dataAccess': {'type': 'All fully open',
  'notes': 'Can be released publicly! :D'},
 'identifyingOrganisms': ['Human', 'Mouse', 'Other'],
 'primaryWrangler': '5ece3464ec0680746267e784',
 'secondaryWrangler': None,
 'wranglingState': 'Eligible',
 'wranglingPriority': 1,
 'wranglingNotes': 'This is an awesome project and I will finish it soon',
 'isInCatalogue': True,
 'cataloguedDate': '2022-08-31T14:06:06.624Z',
 'publicationsInfo': None,
 'dcpReleaseNumber': None,
 'projectLabels': None,
 'hasOpenSubmission': False,
 '_links': {'self': {'href': 'https://api.ingest.staging.archive.data.humancellatlas.org/projects/630f6ab106f1711fccbe4d69'},
  'project': {'href': 'https://api.ingest.staging.archive.data.humancellatlas.org/projects/630f6ab106f1711fccbe4d69',
   'title': 'A single project'},
  'validating': {'href': 'https://api.ingest.staging.archive.data.humancellatlas.org/projects/630f6ab106f1711fccbe4d69/validatingEvent'},
  'bundleManifests': {'href': 'https://api.ingest.staging.archive.data.humancellatlas.org/projects/630f6ab106f1711fccbe4d69/bundleManifests',
   'title': 'Access or create bundle manifests (describing which submitted contents went into which bundle in the datastore)'},
  'auditLogs': {'href': 'https://api.ingest.staging.archive.data.humancellatlas.org/projects/630f6ab106f1711fccbe4d69/auditLogs'},
  'supplementaryFiles': {'href': 'https://api.ingest.staging.archive.data.humancellatlas.org/projects/630f6ab106f1711fccbe4d69/supplementaryFiles'},
  'submissionEnvelopes': {'href': 'https://api.ingest.staging.archive.data.humancellatlas.org/projects/630f6ab106f1711fccbe4d69/submissionEnvelopes',
   'title': 'Access or create new submission envelopes'},
  'submissionEnvelope': {'href': 'https://api.ingest.staging.archive.data.humancellatlas.org/projects/630f6ab106f1711fccbe4d69/submissionEnvelope',
   'title': 'A single submission envelope'}}}
</code></pre></div> </div> </details> <h3 id="interactive-view-notebook"> <a href="#interactive-view-notebook" class="anchor-heading" aria-labelledby="interactive-view-notebook"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Interactive view (Notebook) </h3> <p><a href="https://colab.research.google.com/github/ebi-ait/hca-ebi-dev-team/blob/feature%2Fdcp-834-programmatic-submissions/scripts/programmatic_submissions/programmatic_submissions.ipynb" target="_parent"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab" /></a></p> <p><a target="_blank" href="https://raw.githubusercontent.com/ebi-ait/ingest-programmatic-submissions/main/notebooks/create_project/programmatic_submissions.ipynb" download="" class="btn">Download Notebook</a></p> <h2 id="understanding-the-metadata"> <a href="#understanding-the-metadata" class="anchor-heading" aria-labelledby="understanding-the-metadata"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Understanding the metadata </h2> <p>In the example above, this is the metadata that we have initially sent:</p> <details> <summary> Project JSON metadata </summary> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"describedBy"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://schema.staging.data.humancellatlas.org/type/project/17.0.0/project"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"schema_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"project"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"project_core"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"project_short_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"myCoolLabel"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"project_title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Test_project_with_minimum_information"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"project_description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"This is a test project with minimum information for the programmatic submissions guide"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"contributors"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Enrique,,Ventura"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"enrique@ebi.ac.uk"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"institution"</span><span class="p">:</span><span class="w"> </span><span class="s2">"EMBL-EBI"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"corresponding_contributor"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="nl">"project_role"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"data curator"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"ontology"</span><span class="p">:</span><span class="w"> </span><span class="s2">"EFO:0009737"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"ontology_label"</span><span class="p">:</span><span class="w"> </span><span class="s2">"data curator"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nl">"publications"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"authors"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"Lorem IP"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"Sed UP"</span><span class="w">
      </span><span class="p">],</span><span class="w">
      </span><span class="nl">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"A combined approach for single-cell mRNA and intracellular protein expression analysis"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://www.frontiersin.org/articles/10.3389/fcell.2020.00384/full"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"official_hca_publication"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nl">"funders"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"grant_title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"a cool grant"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"grant_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"000000000bp1"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"organization"</span><span class="p">:</span><span class="w"> </span><span class="s2">"EMBL-EBI"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div> </details> <p>This piece of metadata, in JSON format, is what we call an <strong>instance</strong> of a schema. These instances point out to the schema it should be validated against, in this case, the <a href="https://schema.staging.data.humancellatlas.org/type/project/17.0.0/project">project v17.0.0</a> schema.</p> <p>This schema validates all the necessary information, and this information is what will be submitted downstream (e.g. to the HCA-DCP Data portal). However, the project JSON object has another type of metadata. This metadata is mainly used by the ingest system, both to filter datasets within the system (triage operations) and to expose minimal information about datasets that are of interest to the Human Cell Atlas (<a href="https://www.ebi.ac.uk/humancellatlas/project-catalogue/">HCA Project catalogue</a>)</p> <p>In the following subsections, there will be an explanation on how to understand specifically the project schema and how to expand on it.</p> <h3 id="schema-fields"> <a href="#schema-fields" class="anchor-heading" aria-labelledby="schema-fields"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Schema fields </h3> <p>All the schema fields that are accepted can be found under the <a href="https://github.com/HumanCellAtlas/metadata-schema/blob/master/json_schema/type/project/project.json">project type schema</a>. Each field is self-describing, meaning that by looking at the schema, you should be able to figure out what it is and how to fill out the information for that field.</p> <p>A very human-readable webpage is also built from the schemas and can be accessed here: <a href="https://data.humancellatlas.org/metadata/dictionary/project/project">metadata dictionary</a></p> <h3 id="project-metadata-peculiarities-non-schema-fields"> <a href="#project-metadata-peculiarities-non-schema-fields" class="anchor-heading" aria-labelledby="project-metadata-peculiarities-non-schema-fields"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Project metadata peculiarities (Non-schema fields) </h3> <p>As stated previously, the project metadata schema captures some extra information with the goal to:</p> <ul> <li>Help the system understand and show the ownership/provenance/status of the metadata (<code class="language-plaintext highlighter-rouge">System</code>)</li> <li>Help prioritisation of the work for the HCA wranglers (<code class="language-plaintext highlighter-rouge">Prioritisation</code>)</li> <li>Understand the process the current project may go through (<code class="language-plaintext highlighter-rouge">Triage</code>)</li> <li>Display current landscape of HCA data quickly into the HCA DCP Project Catalogue (<code class="language-plaintext highlighter-rouge">Triage</code>)</li> </ul> <p>There are many fields available outside of the <code class="language-plaintext highlighter-rouge">content</code> field; here, we will go one by one, explaining them in detail.</p> <h4 id="system-fields"> <a href="#system-fields" class="anchor-heading" aria-labelledby="system-fields"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> System fields </h4> <p>These fields will be <strong>filled automatically</strong>. You do not need to worry about them. Most of the fields are shared amongst all entities in ingest; for more information, you can go back to <a href="../introduction/introduction.html#system-specific-fields">System-specific fields</a>. Nonetheless, the project has 4 exclusive system fields that are unique to the project and showcase provenance information for the project metadata:</p> <ul> <li><code class="language-plaintext highlighter-rouge">cataloguedDate</code>: Date at which the project was first exposed in the HCA DCP Project Catalogue.</li> <li><code class="language-plaintext highlighter-rouge">publicationsInfo</code>: Information about the publication related to this dataset. This information is surfaced automatically from the publication-related schema fields.</li> <li><code class="language-plaintext highlighter-rouge">hasOpenSubmission</code>: Boolean value, indicating if the project is linked to an open submission; more on submission statuses on the submissionEnvelopes document.</li> <li><code class="language-plaintext highlighter-rouge">accession</code>: UI-focused field; for programmatic submissions, it is not necessary.</li> </ul> <h4 id="prioritisation-fields"> <a href="#prioritisation-fields" class="anchor-heading" aria-labelledby="prioritisation-fields"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Prioritisation fields </h4> <p>As a user, you do not need to worry about these fields. Feel free to skip filling this information; this will be used by the wranglers</p> <ul> <li><code class="language-plaintext highlighter-rouge">primaryWrangler</code>: ID of the user that is mainly responsible for wrangling this data.</li> <li><code class="language-plaintext highlighter-rouge">secondaryWrangler</code>: ID of another user related to this project; not necessarily the main person of contact.</li> <li><code class="language-plaintext highlighter-rouge">wranglingState</code>: Wrangling status, which may be one of the following values: <ul> <li>New</li> <li>Eligible</li> <li>Not eligible</li> <li>In progress</li> <li>Stalled</li> <li>Submitted</li> <li>Published in DCP</li> <li>Deleted</li> <li>New suggestion</li> </ul> </li> <li><code class="language-plaintext highlighter-rouge">wranglingPriority</code>: Priority assigned to the dataset, from 1 (More important) to 3.</li> <li><code class="language-plaintext highlighter-rouge">wranglingNotes</code>: Free text string to include notes about the project.</li> </ul> <h4 id="triage-fields"> <a href="#triage-fields" class="anchor-heading" aria-labelledby="triage-fields"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Triage fields </h4> <ul> <li><code class="language-plaintext highlighter-rouge">dcpReleaseNumber</code>: Number of DCP release this has been released to.</li> <li><code class="language-plaintext highlighter-rouge">projectLabels</code>: Label of the project. This field helps wranglers assess the route the data will go through.</li> <li><code class="language-plaintext highlighter-rouge">isInCatalogue</code>: Boolean value, indicating if this project is to be surfaced in the catalogue. If <code class="language-plaintext highlighter-rouge">true</code>, the information will appear immediately in the project catalogue.</li> <li><code class="language-plaintext highlighter-rouge">releaseDate</code>: Date of release of the data, in YYYY-MM-DDThh:mm:ssZ format</li> <li><code class="language-plaintext highlighter-rouge">accessionDate</code>: Date by which the data wants to be archived, in YYYY-MM-DDThh:mm:ssZ format</li> <li><code class="language-plaintext highlighter-rouge">dataAccess</code>: Type of access for the data from this dataset. Currently, we only accept raw data for full open access datasets or count matrices/processed data for datasets that require controlled access. Its value is an object, that contains: <ul> <li><code class="language-plaintext highlighter-rouge">type</code>: Value extracted from the following enum: <ul> <li><code class="language-plaintext highlighter-rouge">All fully open</code></li> <li><code class="language-plaintext highlighter-rouge">All managed access</code></li> <li><code class="language-plaintext highlighter-rouge">A mixture of open and managed</code></li> <li><code class="language-plaintext highlighter-rouge">it's complicated</code></li> </ul> </li> <li><code class="language-plaintext highlighter-rouge">notes</code>: a free string value for the user to put the data access restrictions in context.</li> </ul> </li> </ul> <p>The next set of fields are especially important, since they get <strong>surfaced in the project catalogue</strong>:</p> <ul> <li><code class="language-plaintext highlighter-rouge">cellCount</code>: Number of cells that were newly generated in this dataset</li> <li><code class="language-plaintext highlighter-rouge">identifyingOrganisms</code>: Array of strings, that can accept any of these values: <ul> <li><code class="language-plaintext highlighter-rouge">Human</code></li> <li><code class="language-plaintext highlighter-rouge">Mouse</code></li> <li><code class="language-plaintext highlighter-rouge">Other</code></li> </ul> </li> <li><code class="language-plaintext highlighter-rouge">technology</code>: Array of library preparation technologies that were used to generate the data for this project. It is an ontologised field, that only accepts terms under <a href="https://ontology.archive.data.humancellatlas.org/ontologies/efo/terms?iri=http%3A%2F%2Fpurl.obolibrary.org%2Fobo%2FOBI_0000711">library preparation</a> . However, since it‚Äôs outside of the schema, it is encapsulated with another option. The way to fill it: <ul> <li><code class="language-plaintext highlighter-rouge">ontologies</code>: Array of objects, each following the <a href="../introduction/introduction.html#ontologised-fields">ontologies format</a></li> <li><code class="language-plaintext highlighter-rouge">others</code>: Array of free strings, in case the ontology value is not available for the technology Example: <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="nl">"technology"</span><span class="p">:</span><span class="w"> 
</span><span class="p">{</span><span class="nl">"ontologies"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
</span><span class="p">{</span><span class="w">
  </span><span class="nl">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10x 3' v2"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"ontology"</span><span class="p">:</span><span class="w"> </span><span class="s2">"EFO:0009899"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"ontology_label"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10x 3' v2"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="p">]},</span><span class="w"> 
</span><span class="nl">"others"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
  </span><span class="s2">"CoolTech"</span><span class="w">
</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div> </div> </li> </ul> </li> <li><code class="language-plaintext highlighter-rouge">organ</code>: Very similar to technologies, but only allowing the <code class="language-plaintext highlighter-rouge">ontologies</code> field. The ontology value is evaluated to be a term under <a href="https://ontology.archive.data.humancellatlas.org/ontologies/hcao/terms?iri=http%3A%2F%2Fpurl.obolibrary.org%2Fobo%2FUBERON_0001062">anatomical entity</a>.</li> </ul> <h2 id="creating-your-own-project-metadata"> <a href="#creating-your-own-project-metadata" class="anchor-heading" aria-labelledby="creating-your-own-project-metadata"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Creating your own project metadata </h2> <p>In the previous section, you have learnt about the project metadata schema, its allowed properties and how they are supposed to be filled. With this knowledge in mind, you can create your own entity, that could be used to create a project.</p> <p>There are no limits to how many projects you can create, so try to add and experiment! (But don‚Äôt forget to delete them afterwards!).</p> <p>The only thing that you need to remember is to add the out-of-schema information afterwards. The easiest way to do that is by retrieving the project (If not already retrieved) and modifying the information according to the guidelines of the <a href="#project-metadata-peculiarities">project metadata peculiarities</a> section.</p> <h2 id="api-utilities"> <a href="#api-utilities" class="anchor-heading" aria-labelledby="api-utilities"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> API utilities </h2> <h3 id="searching-forretrieving-your-project"> <a href="#searching-forretrieving-your-project" class="anchor-heading" aria-labelledby="searching-forretrieving-your-project"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Searching for/Retrieving your project </h3> <p>If you have generated a project in ingest, but you have forgotten its UUID, there are a couple ways you can retrieve it back:</p> <ul> <li>Using the IngestApi function: <code class="language-plaintext highlighter-rouge">IngestApi.get_user_projects</code>. This requires you to have set up your token beforehand, and it will retrieve all the projects that you have created.</li> <li>Going to the <code class="language-plaintext highlighter-rouge">/user/projects/</code> endpoint in the API. If you send a GET request to this endpoint, with the token set-up, you will be able to retrieve all the projects that are assigned to yourself.</li> </ul> <p>If you remember the project UUID, you can also retrieve the project by calling <code class="language-plaintext highlighter-rouge">IngestApi.get_project_by_uuid(uuid)</code></p> <h3 id="updating-your-project"> <a href="#updating-your-project" class="anchor-heading" aria-labelledby="updating-your-project"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Updating your project </h3> <p>Once you have the project again, updating the project is very simple with the IngestApi object:</p> <ul> <li>Updating metadata schema fields: Send a PATCH request with <code class="language-plaintext highlighter-rouge">{'content': {&lt;fields + values you want to update&gt;}}</code>, e.g. <code class="language-plaintext highlighter-rouge">api.patch(url=ingest_project_url, json={"content": {"insdc_project_accessions": ["SRP000000"]}})</code></li> <li>Updating non-metadata schema fields: Send a PUT request with an updated version of your project</li> </ul> <p>When updating using the IngestApi.put/patch functions, remember to give the <code class="language-plaintext highlighter-rouge">project._links.self.href</code> url as the <code class="language-plaintext highlighter-rouge">url</code> parameter and the content as the <code class="language-plaintext highlighter-rouge">json</code> parameter.</p> <p>The response, if successful, will be the updated version of the project. You can inspect it to ensure the patch has gone through.</p> <p>The most common mistake is to not have your token set up; if you are getting 400 error responses, please check that the token has not expired</p> <h3 id="deleting-your-project"> <a href="#deleting-your-project" class="anchor-heading" aria-labelledby="deleting-your-project"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Deleting your project </h3> <p>If you want to delete your project, you just need to send a DELETE request to the URL of your project. Example: <code class="language-plaintext highlighter-rouge">api.delete(ingest_project_url)</code>.</p> <p>The returning value will always be a response object; to ensure that it has been deleted successfully, you can assert that it‚Äôs a 204 response code by checking the object.</p> <h3 id="accessing-other-entities-from-the-project"> <a href="#accessing-other-entities-from-the-project" class="anchor-heading" aria-labelledby="accessing-other-entities-from-the-project"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Accessing other entities from the project </h3> <p>From the project‚Äôs <code class="language-plaintext highlighter-rouge">_links</code> field, you can access a number of other entities related to this project:</p> <ul> <li><code class="language-plaintext highlighter-rouge">self</code>: link to itself</li> <li><code class="language-plaintext highlighter-rouge">project</code>: link to the project; equivalent to <code class="language-plaintext highlighter-rouge">self</code></li> <li><code class="language-plaintext highlighter-rouge">draft</code>: link to put the project in Draft status; requires an empty POST request.</li> <li><code class="language-plaintext highlighter-rouge">supplementaryFiles</code>: Supplementary files associated with this project</li> <li><code class="language-plaintext highlighter-rouge">submissionEnvelopes</code>: Submissions associated with this project</li> <li><code class="language-plaintext highlighter-rouge">submissionEnvelope</code>: <span style="color:red"><strong><em>OUTDATED</em></strong></span>, please ignore</li> <li><code class="language-plaintext highlighter-rouge">bundleManifests</code>: <span style="color:red"><strong><em>OUTDATED</em></strong></span>, please ignore</li> <li><code class="language-plaintext highlighter-rouge">auditLogs</code>: <span style="color:red"><strong><em>OUTDATED</em></strong></span>, please ignore</li> </ul> <hr> <footer> <div class="d-flex mt-2"> <p class="text-small text-grey-dk-000 mb-0"> <a href="https://github.com/morphic-bio/homepage/edit/main/.//docs/create_a_project/create_a_project.md" id="edit-this-page">Edit this page on GitHub</a> </p> </div> </footer> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
